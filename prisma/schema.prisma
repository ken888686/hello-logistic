generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")
}

enum Role {
  USER
  ADMIN
}

// User
model User {
  id             Int      @id @default(autoincrement())
  username       String   @unique @db.VarChar(255)
  password       String   @db.VarChar(255)
  email          String   @unique @db.VarChar(255)
  display_name   String?  @db.VarChar(255)
  first_name     String?  @db.VarChar(255)
  last_name      String?  @db.VarChar(255)
  photo_url      String?  @db.VarChar(255)
  email_verified Boolean  @default(false)
  enabled        Boolean  @default(true)
  role           Role     @default(USER)
  created_at     DateTime @default(now()) @db.Timestamptz
  updated_at     DateTime @updatedAt @db.Timestamptz

  userAddress UserAddress[]
  UserPayment UserPayment[]
}

model UserAddress {
  id            Int     @id @default(autoincrement())
  user_id       Int
  address_line1 String? @db.VarChar(255)
  address_line2 String? @db.VarChar(255)
  city          String  @db.VarChar(255)
  postal_code   String  @db.VarChar(255)
  country       String  @db.VarChar(255)
  telephone     String  @db.VarChar(255)
  mobile        String  @db.VarChar(255)

  user User @relation(fields: [user_id], references: [id])
}

model UserPayment {
  id           Int     @id @default(autoincrement())
  user_id      Int
  payment_type String? @db.VarChar(255)
  provider     String? @db.VarChar(255)
  account_no   String? @db.VarChar(255)
  expiry_date  String? @db.VarChar(255)

  user User @relation(fields: [user_id], references: [id])
}

// Product
model Product {
  id           Int      @id @default(autoincrement())
  name         String   @db.VarChar(255)
  description  String?  @db.Text
  SKU          String   @db.VarChar(255)
  category_id  Int
  inventory_id Int      @unique
  price        Decimal  @db.Decimal(25, 0)
  discount_id  Int?
  created_at   DateTime @default(now()) @db.Timestamptz
  updated_at   DateTime @updatedAt @db.Timestamptz

  ProductCategory  ProductCategory  @relation(fields: [category_id], references: [id])
  ProductInventory ProductInventory @relation(fields: [inventory_id], references: [id])
  ProductDiscount  ProductDiscount? @relation(fields: [discount_id], references: [id])
}

model ProductCategory {
  id          Int      @id @default(autoincrement())
  name        String   @db.VarChar(255)
  description String?  @db.Text
  created_at  DateTime @default(now()) @db.Timestamptz
  updated_at  DateTime @updatedAt @db.Timestamptz

  product Product[]
}

model ProductInventory {
  id         Int      @id @default(autoincrement())
  quantity   Int      @default(0) @db.Integer
  created_at DateTime @default(now()) @db.Timestamptz
  updated_at DateTime @updatedAt @db.Timestamptz

  product Product?
}

model ProductDiscount {
  id                  Int      @id @default(autoincrement())
  name                String   @db.VarChar(255)
  description         String?  @db.Text
  discount_percentage Decimal  @default(0) @db.Decimal
  active              Boolean  @default(false) @db.Boolean
  created_at          DateTime @default(now()) @db.Timestamptz
  updated_at          DateTime @updatedAt @db.Timestamptz

  product Product[]
}
